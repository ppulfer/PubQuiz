@using PubQuiz.Web.Models

<h3 class="mb-4">@Question.Text</h3>

@if (HasAnswered)
{
    <div class="card">
        <div class="card-body text-center">
            <div class="alert alert-info mb-0">
                Your answer: <strong>@SubmittedAnswer</strong>
                <br/>
                <small class="text-muted">Waiting for results...</small>
            </div>
        </div>
    </div>
}
else
{
    <div class="card">
        <div class="card-body">
            <div class="mb-3">
                <input type="text" class="form-control form-control-lg" @bind="_answer" @bind:event="oninput"
                       placeholder="Type your answer..." disabled="@(TimeRemaining <= 0)" />
            </div>
            <button class="btn btn-primary btn-lg w-100" @onclick="SubmitAnswer"
                    disabled="@(string.IsNullOrWhiteSpace(_answer) || TimeRemaining <= 0)">
                Submit Answer
            </button>
        </div>
    </div>
}

@code {
    [Parameter, EditorRequired] public Question Question { get; set; } = null!;
    [Parameter] public int TimeRemaining { get; set; }
    [Parameter] public bool HasAnswered { get; set; }
    [Parameter] public string SubmittedAnswer { get; set; } = string.Empty;
    [Parameter] public AnswerStatus AnswerStatus { get; set; }
    [Parameter] public int PointsAwarded { get; set; }
    [Parameter] public EventCallback<string> OnAnswerSubmitted { get; set; }

    private string _answer = string.Empty;

    private async Task SubmitAnswer()
    {
        if (!string.IsNullOrWhiteSpace(_answer))
        {
            await OnAnswerSubmitted.InvokeAsync(_answer);
        }
    }
}
